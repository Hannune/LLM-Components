{
  "name": "Agent: Researcher",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "agent-researcher",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-node",
      "name": "Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [250, 300],
      "webhookId": "agent-researcher"
    },
    {
      "parameters": {
        "url": "http://host.docker.internal:8004/search",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({\n  \"keywords\": [$json.body.query],\n  \"timespan\": \"7d\",\n  \"max_results\": 10\n}) }}",
        "options": {}
      },
      "id": "gdelt-search",
      "name": "GDELT Search",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 3,
      "position": [470, 300]
    },
    {
      "parameters": {
        "jsCode": "const articles = $input.first().json.articles;\nconst query = $('Webhook').first().json.body.query;\n\nconst summary = {\n  query: query,\n  article_count": articles.length,\n  sources: [...new Set(articles.map(a => a.domain))],\n  articles: articles.slice(0, 5).map(a => ({\n    title: a.title,\n    url: a.url,\n    source: a.domain\n  }))\n};\n\nreturn { json: summary };"
      },
      "id": "process-results",
      "name": "Process Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [690, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {}
      },
      "id": "respond",
      "name": "Respond",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [910, 300]
    }
  ],
  "connections": {
    "Webhook": {
      "main": [[{ "node": "GDELT Search", "type": "main", "index": 0 }]]
    },
    "GDELT Search": {
      "main": [[{ "node": "Process Results", "type": "main", "index": 0 }]]
    },
    "Process Results": {
      "main": [[{ "node": "Respond", "type": "main", "index": 0 }]]
    }
  },
  "active": true,
  "settings": {},
  "id": "agent-researcher"
}
